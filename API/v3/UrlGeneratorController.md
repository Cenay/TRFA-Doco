#UrlGeneratorController

The purpose of URL generator contorller is to build a URL Kids/Adult parites & Field Trips url from party info inside **party field** in Active Campaign.
There are three routes for generating URLs.
```
Route::get('/url/{class}/{id}', 'UrlGeneratorController@ajaxRedirectToUrl');
Route::get('/party/{class}/{id}/{redirect?}', 'UrlGeneratorController@index')->name('urlGenerator');;
Route::get('/{class}/{id}/{redirect?}', 'UrlGeneratorController@index')->name('urlOldGenerator');
(The last endpoint is added so that the link in the old emails does not break)
```

###Methods
####ajaxRedirectToUrl
ajaxRedirectToUrl is a simple method that just returns url generator view where we display the loader until redirected to the correct url.

####index
index methods takes 3 arguments. 
`$class, $contactId, $redirect = null`
`$class` define what type of class it is i.e. kids class, adult class or field trips. Based on the class name it will redirect to the method responsible to generating url for that class. For example in class of kids class flow will be redirected to `constructKidsPartyUrl` method. 

####constructKidsPartyUrl
This method takes two arguments `$contactId, $redirect`.
`$contactId` is the active campaigns contact id and `$redirect` is a boolean. When it is true it will redirect the user directly to redirects url. (This was the intial approach that we implemented first and later we added a loader view because generating a url and then redirecting to it was taking some with and we wanted to give use some feedback).
This method fetchs the details from acitve campaign by calling another method `$details = $this->getContactDetailsFromActiveCampaign($contactId, 60);`
We've passed 60 as second parameter, and 60 is id of **Kids party info 1** in active campaign.

####getContactDetailsFromActiveCampaign
getContactDetailsFromActiveCampaign method takes two arguments
Active Campaign Contact Id &Active Campaign Info Field's Id.
this method will return array containing contact information and kids party info 1 value. 
If **kids party info 1** field is empty then we just redirect to base url with contact information only. i.e, name, email, phone etc.
If there is a value then we explode the information by PHP_EOL. From the first line of **kids party info 1** we extract the package name. We extract the package name becase that will tell us what should be the redirect url because in case of kids parties we have 3 forms i.e top, budding and executive. 
We then build query sending by the information in **kids party info 1** by calling `buildQueryString` method. 

####buildQueryString
Build query string uses a built in PHP method "http_build_query" to build a query stirng from the array passed. 
The array is generated by calling a method `searchArrayValue` against each key
If location is set of "my location" then we make a call to another mthod which will get us the locaiton value address, city, state, zip.

####buildQueryStringForAdultsParty
Just like the above method this detals with adult parties

####buildQueryStringForFieldTrips
This method is almost same like buildQueryString but it will generate the query string for field trips.

####searchArrayValue
This method takes 3 parameters `$hayStack, $needle, $index` i.e.
`'entree' => $this->searchArrayValue($kidsPartyInfoField, 'Entree', 1)`
In this example it will look for keyword *entree* and then split that line by **':'** and takes party depending upon index. 

####getLocationDetails
If in party details location is set to "my location" then we need location values like address, city, state and zip
Following are the active campaign id's for each field we need. 
34: Address 1, 36: City , 37: State ,38: Zip
This method will query active campaign get the data in these fields and return back the array



